<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ูุงุฑูููู - ุชุญููฺฏุฑ ููุด ูุตููุน ุจุงุฒุงุฑูุง ูุงู{% endblock %}</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="{% block meta_description %}ุงููู ุฑุจุงุช ุชูฺฏุฑุงู ูุงุฑุณ ุจุฑุง ุชุญูู ุจุงุฒุงุฑูุง ูุงู ุจุง ููุด ูุตููุน. ุชุญูู ุฑูุฒุงุฑุฒุ ูุงุฑฺฉุณุ ุทูุง ู ุณูุงู ุจุง ุฏูุช ุจุงูุง.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}ูุงุฑูููู, ููุด ูุตููุน, ุชุญูู ุจุงุฒุงุฑ, ุฑูุฒุงุฑุฒ, ุจุชฺฉูู, ูุงุฑฺฉุณ, ุทูุง, ุณูุงู, ุชุฑุฏูฺฏ, ุฑุจุงุช ุชูฺฏุฑุงู, ุชุญูู ุชฺฉูฺฉุงู{% endblock %}">
    <meta name="author" content="ูุงุฑูููู">
    <meta name="robots" content="index, follow">
    <meta name="google-site-verification" content="PaHyC-LeHhk-AtbfajelmxUhHk9mbLssN-wHmM-iV6g" />    

    <!-- Open Graph -->
    <meta property="og:title" content="{% block og_title %}{{ self.title() }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.meta_description() }}{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:image" content="{{ url_for('static', path='images/narmoon-og.webp') }}">
    <meta property="og:locale" content="fa_IR">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ self.og_title() }}">
    <meta name="twitter:description" content="{{ self.og_description() }}">
    <meta name="twitter:image" content="{{ url_for('static', path='images/narmoon-og.webp') }}">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="ูุงุฑูููู">
    <meta name="msapplication-TileColor" content="#3b82f6">
    
    <!-- Favicon & PWA Icons -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', path='images/favicon.ico') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', path='images/apple-touch-icon.png') }}">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Bootstrap 5 RTL -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet" crossorigin="anonymous">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="{{ url_for('static', path='css/style.min.css') }}" as="style">
    <link rel="preload" href="{{ url_for('static', path='js/main.min.js') }}" as="script">
    <link rel="preload" href="{{ url_for('static', path='images/hero-dashboard.webp') }}" as="image">

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//www.google-analytics.com">

    <!-- Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', path='css/style.min.css') }}?v=2025-optimized">
    
    {% block extra_head %}{% endblock %}
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "ูุงุฑูููู",
        "description": "ุงููู ุฑุจุงุช ุชูฺฏุฑุงู ูุงุฑุณ ุจุฑุง ุชุญูู ุจุงุฒุงุฑูุง ูุงู ุจุง ููุด ูุตููุน",
        "url": "{{ request.base_url }}",
        "logo": "{{ url_for('static', path='images/logo.png') }}",
        "sameAs": [
            "https://t.me/NarmoonAI_BOT"
        ],
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "customer service",
            "url": "https://t.me/NarmoonAI_BOT"
        }
    }
    </script>
</head>
<body>
   <!-- Header -->
   <header class="header sticky-top">
       <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
           <div class="container">
               <!-- Logo -->
               <a class="navbar-brand" href="{{ url_for('home') }}">
                   <img src="{{ url_for('static', path='images/logo.png') }}" alt="ูุงุฑูููู" height="50" class="d-inline-block align-text-top">
                   <span class="brand-text me-2">ูุงุฑูููู</span>
               </a>

               <!-- Mobile Toggle -->
               <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                   <span class="navbar-toggler-icon"></span>
               </button>

               <!-- Navigation -->
               <div class="collapse navbar-collapse" id="navbarNav">
                   <ul class="navbar-nav me-auto">
                       <li class="nav-item">
                           <a class="nav-link {% if request.url.path == '/' %}active{% endif %}" href="{{ url_for('home') }}">
                               <i class="fas fa-home me-1"></i>ุฎุงูู
                           </a>
                       </li>
                       <li class="nav-item">
                           <a class="nav-link {% if 'about' in request.url.path %}active{% endif %}" href="/about">
                               <i class="fas fa-info-circle me-1"></i>ุฏุฑุจุงุฑู ูุงุฑูููู
                           </a>
                       </li>
                       <li class="nav-item">
                           <a class="nav-link {% if 'blog' in request.url.path %}active{% endif %}" href="/blog">
                               <i class="fas fa-blog me-1"></i>ูุจูุงฺฏ
                           </a>
                       </li>
                       <li class="nav-item">
                           <a class="nav-link {% if 'videos' in request.url.path %}active{% endif %}" href="{{ url_for('videos') }}">
                               <i class="fas fa-play-circle me-1"></i>ูุฏููุง ุขููุฒุด
                           </a>
                       </li>
                       <li class="nav-item">
                           <a class="nav-link {% if 'articles' in request.url.path %}active{% endif %}" href="{{ url_for('articles') }}">
                               <i class="fas fa-newspaper me-1"></i>ููุงูุงุช ุขููุฒุด
                           </a>
                       </li>
                   </ul>

                   <!-- CTA Button -->
                   <a href="https://t.me/NarmoonAI_BOT" class="btn btn-primary cta-btn" target="_blank">
                       <i class="fab fa-telegram me-2"></i>ุดุฑูุน ุจุง ุฑุจุงุช ุชูฺฏุฑุงู
                   </a>
               </div>
           </div>
       </nav>
   </header>

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer bg-dark text-light py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <div class="footer-brand mb-4">
                        <img src="{{ url_for('static', path='images/logo-white.png') }}" alt="ูุงุฑูููู" height="40" class="mb-2">
                        <h5 class="text-primary">ูุงุฑูููู</h5>
                        <p class="text-muted">ุชุญููฺฏุฑ ุญุฑููโุง ุจุงุฒุงุฑูุง ูุงู ุจุง ููุด ูุตููุน</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <h6 class="text-primary mb-3">ููฺฉโูุง ููุฏ</h6>
                    <ul class="list-unstyled footer-links">
                        <li><a href="{{ url_for('home') }}">ุตูุญู ุงุตู</a></li>
                        <li><a href="{{ url_for('videos') }}">ูุฏููุง ุขููุฒุด</a></li>
                        <li><a href="{{ url_for('articles') }}">ููุงูุงุช</a></li>
                        <li><a href="https://t.me/NarmoonAI_BOT" target="_blank">ุฑุจุงุช ุชูฺฏุฑุงู</a></li>
                    </ul>
                </div>
                <div class="col-lg-3">
                    <h6 class="text-primary mb-3">ุงุฑุชุจุงุท ุจุง ูุง</h6>
                    <div class="social-links">
                        <a href="https://t.me/NarmoonAI_BOT" target="_blank" class="btn btn-outline-primary btn-sm me-2 mb-2">
                            <i class="fab fa-telegram me-1"></i>ุชูฺฏุฑุงู
                        </a>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <div class="row">
                <div class="col-md-6">
                    <p class="small text-muted mb-0">ยฉ {{ current_year }} ูุงุฑูููู. ุชูุงู ุญููู ูุญููุธ ุงุณุช.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="small text-muted mb-0">ุทุฑุงุญ ุดุฏู ุจุง โค๏ธ ุจุฑุง ุชุฑุฏุฑูุง ุงุฑุงู</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{{ url_for('static', path='js/main.min.js') }}"></script>
    
    <!-- PWA Service Worker -->
    <script>
        // ุซุจุช Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/static/js/sw.js')
                    .then(function(registration) {
                        console.log('โ Service Worker ุซุจุช ุดุฏ:', registration.scope);
                    }, function(err) {
                        console.log('โ Service Worker ุซุจุช ูุดุฏ:', err);
                    });
            });
        }

        // PWA Install Button
        let deferredPrompt;
        const installButton = document.createElement('button');
        installButton.textContent = '๐ฑ ูุตุจ ุงูพ';
        installButton.className = 'btn btn-outline-primary btn-sm position-fixed';
        installButton.style.cssText = `
            bottom: 20px;
            right: 80px;
            z-index: 1000;
            display: none;
            border-radius: 25px;
            font-size: 14px;
            padding: 8px 16px;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        `;
        document.body.appendChild(installButton);

        // ููุงุด ุฏฺฉูู ูุตุจ
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installButton.style.display = 'block';
        });

        // ฺฉูฺฉ ุฑู ุฏฺฉูู ูุตุจ
        installButton.addEventListener('click', (e) => {
            installButton.style.display = 'none';
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('โ ฺฉุงุฑุจุฑ ุงูพ ุฑุง ูุตุจ ฺฉุฑุฏ');
                    } else {
                        console.log('โ ฺฉุงุฑุจุฑ ุงูพ ุฑุง ูุตุจ ูฺฉุฑุฏ');
                    }
                    deferredPrompt = null;
                });
            }
        });

        // ูุฎู ฺฉุฑุฏู ุฏฺฉูู ุจุนุฏ ุงุฒ ูุตุจ
        window.addEventListener('appinstalled', (evt) => {
            console.log('โ ุงูพ ูุตุจ ุดุฏ');
            installButton.style.display = 'none';
        });
    </script>
    
    {% block extra_scripts %}{% endblock %}
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VPSEE0QF1E"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VPSEE0QF1E');
    </script>
</body>
</html>
